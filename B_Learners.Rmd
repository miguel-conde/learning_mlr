---
title: "mlR - Learners"
author: "Miguel Conde"
date: "3 de marzo de 2017"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE,
                      fig.align = "center")
```

```{r}
require(mlr)
```

## Learners

Unified interface to all popular machine learning methods in R: (cost-sensitive) classification, regression, survival analysis, and clustering. Many are already integrated in mlr, others are not, but the package is specifically designed to make extensions simple.

A learner in mlr is generated by calling makeLearner. In the constructor you need to specify which learning method you want to use. Moreover, you can:

* Set hyperparameters.
* Control the output for later prediction, e.g., for classification whether you want a factor of predicted class labels or probabilities.
* Set an ID to name the object (some methods will later use this ID to name results or annotate plots).

### Regression
```{r}
## Regression gradient boosting machine, specify hyperparameters via a list
# (Hyperparameter values can be specified either via the ... argument or as 
# a list via par.vals)
regr.lrn = makeLearner("regr.gbm", 
                       par.vals = list(n.trees = 500, interaction.depth = 3))
regr.lrn
```

### Classification
```{r}
## Classification tree, set it up for predicting probabilities
classif.lrn = makeLearner("classif.randomForest", predict.type = "prob",
                          fix.factors.prediction = TRUE)
classif.lrn
```

### Survival
```{r}
## Cox proportional hazards model with custom name
surv.lrn = makeLearner("surv.coxph", id = "cph")
surv.lrn
```

### Multilabel
```{r}
## Multilabel Random Ferns classification algorithm
multilabel.lrn = makeLearner("multilabel.rFerns")
multilabel.lrn
```

### Cluster analysis

```{r}
## K-means with 5 clusters
cluster.lrn = makeLearner("cluster.kmeans", centers = 5)
cluster.lrn
```

### Cost-sensitive classification

There is currently no special learner class for cost-sensitive classification. For ordinary misclassification costs you can use standard classification methods. For example-dependent costs there are several ways to generate cost-sensitive learners from ordinary regression and classification learners.

## Accessing a learner
```{r}
## Get the configured hyperparameter settings that deviate from the defaults
cluster.lrn$par.vals
```

```{r}
## Get the set of hyperparameters
classif.lrn$par.set
```


```{r}
## Get the type of prediction
regr.lrn$predict.type
```

```{r}
## Get current hyperparameter settings
getHyperPars(cluster.lrn)
```

```{r}
## Get a description of all possible hyperparameter settings
getParamSet(classif.lrn)
```

```{r}
getParamSet("classif.randomForest")
```


## Modifying a learner

```{r}
## Change the ID
surv.lrn = setLearnerId(surv.lrn, "CoxModel")
surv.lrn
```

```{r}
## Change the prediction type, predict a factor with class labels instead of probabilities
classif.lrn = setPredictType(classif.lrn, "response")

## Change hyperparameter values
cluster.lrn = setHyperPars(cluster.lrn, centers = 4)

## Go back to default hyperparameter values
regr.lrn = removeHyperPars(regr.lrn, c("n.trees", "interaction.depth"))

```

## Listing learners
```{r}
## List everything in mlr
lrns = listLearners()
head(lrns[c("class", "package")])
```

```{r}
## List classifiers that can output probabilities
lrns = listLearners("classif", properties = "prob")
head(lrns[c("class", "package")])
```

```{r}
## List classifiers that can be applied to iris (i.e., multiclass) and output probabilities
lrns = listLearners(iris.task, properties = "prob")
head(lrns[c("class", "package")])
```

```{r}
## The calls above return character vectors, but you can also create learner objects
head(listLearners("cluster", create = TRUE), 2)
```

